<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SWEET MASTER: KEKECAN ED.</title>
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-dark: #050510;
            --neon-pink: #ff0055;
            --neon-blue: #00f2ff;
            --neon-green: #00ff66;
            --gold: #ffd700;
            --panel-bg: rgba(10, 10, 25, 0.95);
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0;
            height: 100dvh; /* BEYAZ Ã‡Ä°ZGÄ° Ã‡Ã–ZÃœMÃœ */
            background: radial-gradient(circle at center, #1b1b3a 0%, #050510 100%);
            font-family: 'Orbitron', sans-serif;
            color: white;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- ÃœST PANEL --- */
        .top-bar {
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            background: rgba(0,0,0,0.6);
            border-bottom: 2px solid var(--neon-blue);
            box-shadow: 0 0 20px var(--neon-blue);
            z-index: 100;
        }

        .menu-icon { font-size: 1.8rem; color: var(--neon-blue); cursor: pointer; }

        .balance-box {
            background: linear-gradient(90deg, #111, #333);
            padding: 8px 20px;
            border-radius: 50px;
            border: 2px solid var(--gold);
            font-weight: 900;
            font-size: 1.1rem;
            color: var(--gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- OYUN ALANI --- */
        #game-area {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 10px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 5px;
            width: 100%;
            max-width: 450px;
            aspect-ratio: 6/5;
            background: rgba(255,255,255,0.05);
            padding: 8px;
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(5px);
            transition: 0.3s;
        }
        
        .green-light-mode {
            border: 3px solid var(--neon-green) !important;
            box-shadow: 0 0 50px var(--neon-green), inset 0 0 50px var(--neon-green);
        }

        .symbol {
            width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; background: rgba(0,0,0,0.3);
            border-radius: 8px;
        }

        /* --- MENÃœ (SIDEBAR) --- */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 0;
            width: 280px;
            height: 100%;
            background: rgba(10, 10, 20, 0.98);
            border-right: 2px solid var(--neon-blue);
            z-index: 1000;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        .sidebar.open { left: 0; }
        
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .menu-item {
            padding: 15px; margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 8px; cursor: pointer;
            display: flex; align-items: center; gap: 10px;
        }

        .producer-tag {
            margin-top: auto; text-align: center; padding: 20px;
            border-top: 1px solid #333; color: var(--neon-green);
            font-weight: 900; letter-spacing: 2px;
            animation: flash 3s infinite;
        }

        /* --- ALT KONTROLLER --- */
        .controls {
            height: 100px; background: var(--panel-bg);
            border-top: 2px solid var(--neon-pink);
            display: flex; align-items: center; justify-content: space-around;
            padding: 10px;
        }

        .spin-btn {
            width: 80px; height: 80px; border-radius: 50%;
            background: radial-gradient(circle, var(--neon-pink), #990033);
            border: 4px solid #fff; color: #fff; font-size: 1.2rem;
            font-weight: 900; box-shadow: 0 0 20px var(--neon-pink);
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 style="color:var(--neon-blue); margin:0;">AYARLAR</h2>
            <i class="fas fa-times" onclick="toggleMenu()" style="font-size:1.5rem; color:var(--neon-pink); cursor:pointer;"></i>
        </div>
        <div class="menu-item" onclick="joinRoomPrompt()"><i class="fas fa-globe"></i> Online Odaya Gir</div>
        <div class="menu-item" onclick="leaveRoom()"><i class="fas fa-sign-out-alt"></i> Odadan AyrÄ±l</div>
        <div class="menu-item" onclick="resetData()"><i class="fas fa-trash"></i> Verileri SÄ±fÄ±rla</div>
        
        <div style="margin-top:20px; color:#888; font-size:0.8rem; text-align:center;">
            Server: <span id="server-status" style="color:red">OFFLINE</span>
        </div>

        <div class="producer-tag">YAPIMCI<br>KEKECAN</div>
    </div>

    <div class="top-bar">
        <i class="fas fa-bars menu-icon" onclick="toggleMenu()"></i>
        <div class="balance-box"><i class="fas fa-lira-sign"></i> <span id="balance">5000</span></div>
        <div style="color:var(--neon-pink); font-weight:bold;"><i class="fas fa-trophy"></i> <span id="last-win">0</span></div>
    </div>

    <div id="game-area">
        <div class="game-grid" id="grid"></div>
        <div id="win-overlay" style="position:absolute; font-size:3rem; font-weight:900; color:var(--gold); display:none; z-index:10;">BIG WIN!</div>
    </div>

    <div class="controls">
        <div style="display:flex; flex-direction:column; align-items:center;">
            <span style="font-size:0.7rem;">BAHÄ°S</span>
            <div style="display:flex; gap:5px;">
                <button onclick="adjBet(-100)" style="background:#333; color:white; border:none; padding:5px 10px;">-</button>
                <span id="bet" style="font-weight:bold;">100</span>
                <button onclick="adjBet(100)" style="background:#333; color:white; border:none; padding:5px 10px;">+</button>
            </div>
        </div>
        <button class="spin-btn" id="spin-btn" onclick="spin()">SPIN</button>
        <button onclick="toggleAuto()" id="auto-btn" style="background:#333; color:white; border:none; padding:10px; border-radius:5px;">OTO: OFF</button>
    </div>

<script>
    // FIREBASE AYARLARI
    const firebaseConfig = {
      apiKey: "AIzaSyAeDY4Bv6hWopJrfeJ7nfgPJRd9VYGEx8B",
      authDomain: "sweet-masters-82504.firebaseapp.com",
      databaseURL: "https://sweet-masters-82504-default-rtdb.firebaseio.com",
      projectId: "sweet-masters-82504",
      storageBucket: "sweet-masters-82504.firebasestorage.app",
      messagingSenderId: "600834822835",
      appId: "1:600834822835:web:db3ea440ccce2031a956c6"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let userId = localStorage.getItem('sm_uid') || "oyuncu_" + Math.floor(Math.random()*99999);
    localStorage.setItem('sm_uid', userId);

    let state = {
        balance: parseInt(localStorage.getItem('sm_bal')) || 5000,
        bet: 100, spinning: false, auto: false, roomID: null, greenLight: false
    };

    function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }

    // MenÃ¼ dÄ±ÅŸÄ±na tÄ±klandÄ±ÄŸÄ±nda kapatma
    document.addEventListener('click', (e) => {
        const sb = document.getElementById('sidebar');
        if(sb.classList.contains('open') && !sb.contains(e.target) && !e.target.classList.contains('menu-icon')) {
            toggleMenu();
        }
    });

    async function spin() {
        if(state.spinning || state.balance < state.bet) return;
        state.spinning = true;
        state.balance -= state.bet;
        state.greenLight = Math.random() < 0.1;
        
        document.getElementById('grid').classList.toggle('green-light-mode', state.greenLight);
        updateUI();

        const cells = document.querySelectorAll('.symbol');
        cells.forEach((c, i) => {
            setTimeout(() => {
                c.innerText = ['ðŸ’Ž', 'â­', 'ðŸ‡', 'ðŸ‰', 'ðŸŒ', 'ðŸ’'][Math.floor(Math.random()*6)];
                c.classList.add('animate__animated', 'animate__bounceInDown');
            }, i * 20);
        });

        await new Promise(r => setTimeout(r, 800));
        checkWin();
    }

    function checkWin() {
        const cells = document.querySelectorAll('.symbol');
        let counts = {};
        cells.forEach(c => counts[c.innerText] = (counts[c.innerText] || 0) + 1);

        let win = 0;
        for(let s in counts) {
            if(counts[s] >= 6) win += (counts[s] * (state.bet / 5));
        }
        if(state.greenLight) win *= 10;

        if(win > 0) {
            state.balance += win;
            const ov = document.getElementById('win-overlay');
            ov.innerText = "+" + Math.floor(win);
            ov.style.display = 'block';
            confetti({ particleCount: 150 });
            setTimeout(() => ov.style.display = 'none', 2000);
        }

        state.spinning = false;
        updateUI();
        if(state.auto) setTimeout(spin, 1200);
    }

    function updateUI() {
        document.getElementById('balance').innerText = Math.floor(state.balance).toLocaleString();
        document.getElementById('bet').innerText = state.bet;
        localStorage.setItem('sm_bal', state.balance);
    }

    function adjBet(v) { if(!state.spinning && state.bet+v >= 100) { state.bet+=v; updateUI(); } }
    
    function toggleAuto() { 
        state.auto = !state.auto; 
        document.getElementById('auto-btn').innerText = "OTO: " + (state.auto ? "ON" : "OFF");
        if(state.auto) spin();
    }

    async function joinRoomPrompt() {
        const { value: room } = await Swal.fire({ title: 'Oda Ä°smi', input: 'text' });
        if(room) {
            state.roomID = room;
            db.ref(`rooms/${room}/${userId}`).set({ status: 'online' });
            db.ref(`rooms/${room}/${userId}`).onDisconnect().remove();
            document.getElementById('server-status').innerText = "ONLINE: " + room;
            document.getElementById('server-status').style.color = "#00ff66";
            toggleMenu();
        }
    }

    function leaveRoom() {
        if(state.roomID) db.ref(`rooms/${state.roomID}/${userId}`).remove();
        state.roomID = null;
        document.getElementById('server-status').innerText = "OFFLINE";
        document.getElementById('server-status').style.color = "red";
        toggleMenu();
    }

    function resetData() { localStorage.clear(); location.reload(); }

    // 5 Dakikada bir 2000 TL Bonus
    setInterval(() => {
        state.balance += 2000;
        updateUI();
        Swal.fire({ toast: true, position: 'top-end', title: '+2.000 TL Bonus!', timer: 3000, showConfirmButton: false });
    }, 300000);

    // Ä°lk grid kurulumu
    for(let i=0; i<30; i++) {
        let c = document.createElement('div');
        c.className = 'symbol';
        c.innerText = 'ðŸ¬';
        document.getElementById('grid').appendChild(c);
    }
    updateUI();
</script>
</body>
</html>
