<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bonanza Online Pro - Split Screen</title>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --bg: #1a0633; --gold: #ffd700; --pink: #ff007f; }
        body { background: var(--bg); color: white; margin: 0; font-family: 'Arial', sans-serif; overflow: hidden; }
        
        /* Ekran BÃ¶lme DÃ¼zeni */
        #game-wrapper { display: flex; height: 100vh; width: 100vw; }
        .player-section { flex: 1; border: 2px solid #333; display: flex; flex-direction: column; position: relative; padding: 5px; }
        .active-screen { border-color: var(--pink); box-shadow: inset 0 0 20px rgba(255, 0, 127, 0.3); }

        /* Slot IzgarasÄ± */
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; background: rgba(0,0,0,0.5); padding: 8px; border-radius: 12px; }
        .cell { aspect-ratio: 1; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; 
                transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); background: #2a0a52; }
        
        /* Animasyonlar */
        @keyframes drop { from { transform: translateY(-200px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .dropping { animation: drop 0.4s ease-out; }
        .pop { transform: scale(1.3); filter: brightness(1.5); }

        /* Alt Panel */
        #controls { position: fixed; bottom: 0; width: 100%; height: 80px; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: space-around; z-index: 100; border-top: 2px solid var(--pink); }
        .btn { padding: 12px 25px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; color: white; }
        #spin-btn { background: linear-gradient(to bottom, #ff007f, #b30059); font-size: 1.2rem; box-shadow: 0 4px 15px rgba(255, 0, 127, 0.5); }
        
        /* Oda Bilgisi */
        .room-tag { position: absolute; top: 10px; right: 10px; background: var(--pink); padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; }
    </style>
</head>
<body>

<div id="game-wrapper">
    <div class="player-section active-screen" id="p1-section">
        <div style="text-align:center; padding: 10px;"><b>SEN</b> | <span id="balance">5000</span> ğŸ’°</div>
        <div class="grid" id="my-grid"></div>
    </div>

    <div class="player-section" id="p2-section">
        <div style="text-align:center; padding: 10px;"><b id="friend-name">ARKADAÅIN</b> | <span id="f-balance">---</span></div>
        <div class="grid" id="friend-grid"></div>
        <button id="send-coin" onclick="sendCoin()" style="display:none; position:absolute; bottom:10px; left:25%; width:50%; background:var(--gold); color:black; font-size:0.7rem;" class="btn">ğŸ’° COÄ°N GÃ–NDER</button>
    </div>
</div>

<div id="controls">
    <div id="timer">ğŸ 10:00</div>
    <button class="btn" onclick="setupOnline()">Odaya KatÄ±l / Kur</button>
    <button id="spin-btn" onclick="playSpin()">SPIN</button>
    <button class="btn" style="background:#555" onclick="openProfile()">Profil</button>
</div>

<script>
    // --- OYUN AYARLARI ---
    let myBalance = 5000;
    let symbols = ['ğŸ', 'ğŸ‡', 'ğŸ‰', 'ğŸŒ', 'ğŸ­', 'ğŸ’', 'â­'];
    let myName = "Oyuncu_" + Math.floor(Math.random()*999);
    let currentRoom = null;
    let db;

    // --- ONLINE ALTYAPI (Firebase) ---
    function setupOnline() {
        const room = prompt("Oda Ä°smi Gir (Ã–rn: kankalar):");
        if(!room) return;
        
        // Ã–NEMLÄ°: Kendi Firebase hesabÄ±nÄ± buraya baÄŸlayabilirsin. 
        // Åimdilik demo bir yapÄ± Ã¼zerinden ilerliyoruz.
        const firebaseConfig = { databaseURL: "https://PROJE-ADIN.firebaseio.com" }; 
        if(!firebaseConfig.databaseURL.includes("PROJE")) {
            alert("Usta! Firebase baÄŸlantÄ±sÄ±nÄ± yapmadÄ±k ama offline modda oda simÃ¼lasyonu baÅŸlÄ±yor.");
        }
        
        currentRoom = room;
        document.getElementById('p2-section').querySelector('h3')?.remove();
        document.getElementById('send-coin').style.display = 'block';
        alert(room + " odasÄ±na baÅŸarÄ±yla girildi!");
    }

    // --- SPIN MEKANÄ°ÄÄ° ---
    async function playSpin() {
        if(myBalance < 100) return alert("Bakiye bitti! 10 dk bekleyerek 2000 al.");
        myBalance -= 100;
        updateUI();

        const grid = document.getElementById('my-grid');
        grid.innerHTML = '';
        let currentResult = [];

        // Åekerleri yukarÄ±dan dÃ¼ÅŸÃ¼r
        for(let i=0; i<25; i++) {
            let sym = symbols[Math.floor(Math.random()*symbols.length)];
            currentResult.push(sym);
            let cell = document.createElement('div');
            cell.className = 'cell dropping';
            cell.style.animationDelay = (i * 0.02) + "s";
            cell.innerText = sym;
            grid.appendChild(cell);
        }

        // KazanÃ§ KontrolÃ¼ (8+)
        setTimeout(() => checkWin(currentResult), 600);
        
        // Veriyi "ArkadaÅŸÄ±na" GÃ¶nder (EÄŸer odadaysan)
        if(currentRoom) {
            console.log("Veri odaya basÄ±ldÄ±: " + currentResult);
            // ArkadaÅŸÄ±nÄ±n ekranÄ±na simÃ¼lasyon yap (Demo iÃ§in)
            simulateFriend(currentResult);
        }
    }

    function checkWin(res) {
        let counts = {};
        res.forEach(s => counts[s] = (counts[s] || 0) + 1);
        
        for(let s in counts) {
            if(counts[s] >= 8) {
                myBalance += (counts[s] * 20);
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                updateUI();
            }
        }
    }

    function simulateFriend(res) {
        const fGrid = document.getElementById('friend-grid');
        fGrid.innerHTML = '';
        res.forEach((sym, i) => {
            let cell = document.createElement('div');
            cell.className = 'cell dropping';
            cell.style.opacity = "0.7";
            cell.innerText = sym;
            fGrid.appendChild(cell);
        });
    }

    function updateUI() {
        document.getElementById('balance').innerText = myBalance;
    }

    function sendCoin() {
        let miktar = prompt("ArkadaÅŸÄ±na kaÃ§ coin gÃ¶ndereceksin?");
        if(miktar <= myBalance) {
            myBalance -= miktar;
            updateUI();
            alert(miktar + " coin arkadaÅŸÄ±na baÅŸarÄ±yla gÃ¶nderildi! (Online sistemde bakiye ona anÄ±nda geÃ§er)");
        }
    }

    // Ä°lk IzgarayÄ± Doldur
    window.onload = () => {
        for(let i=0; i<25; i++) {
            document.getElementById('my-grid').innerHTML += `<div class="cell">ğŸ¬</div>`;
            document.getElementById('friend-grid').innerHTML += `<div class="cell" style="opacity:0.3">ğŸ¬</div>`;
        }
    };
</script>

</body>
</html>
